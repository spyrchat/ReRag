# Advanced Reranking Hybrid Retrieval
description: "Hybrid retrieval with Voyage Premium and advanced reranking"

# Dataset configuration
dataset:
  path: "/home/spiros/Desktop/Thesis/datasets/sosum/data"
  use_ground_truth: true
  
# Retrieval configuration
retrieval:
  type: "hybrid"
  top_k: 30  # Get more candidates for reranking
  score_threshold: 0.01
  fusion_method: rrf
  dense_weight: 0.7
  sparse_weight: 0.3

# Embedding configuration
embedding:
  dense:
    provider: voyage
    model: voyage-3.5
    dimensions: 1024
    api_key_env: VOYAGE_API_KEY
    batch_size: 32
    vector_name: dense
  sparse:
    provider: sparse
    model: Qdrant/bm25
    vector_name: sparse
  strategy: hybrid

# Qdrant collection
qdrant:
  collection: sosum_stackoverflow_hybrid_v1
  dense_vector_name: dense
  sparse_vector_name: sparse

# Retrievers configuration (required by RetrievalPipelineFactory)
retrievers:
  hybrid:
    type: hybrid
    top_k: 20
    score_threshold: 0.01
    dense_weight: 0.7
    sparse_weight: 0.3
    fusion_method: rrf
    fusion:
      method: rrf
      rrf_k: 50
      dense_weight: 0.7
      sparse_weight: 0.3
    performance:
      batch_size: 32
      enable_caching: true
      lazy_initialization: true
      parallel_search: false
    qdrant:
      collection_name: sosum_stackoverflow_hybrid_v1
      dense_vector_name: dense
      sparse_vector_name: sparse
      hybrid_config:
        alpha: 0.5
        reciprocal_rank_constant: 50

# Advanced reranking configuration
reranking:
  enabled: true
  model: "cross-encoder/ms-marco-TinyBERT-L-2-v2"  # Faster alternative
  # model: "cross-encoder/ms-marco-MiniLM-L-6-v2"   # Current (balanced)
  # model: "cross-encoder/ms-marco-MiniLM-L-12-v2"  # Larger/better
  top_k: 10
  batch_size: 16

# Fusion method configuration
fusion:
  method: rrf
  rrf_k: 50
  dense_weight: 0.7
  sparse_weight: 0.3

# Evaluation configuration
evaluation:
  k_values: [1, 5, 10, 15, 20]
  metrics:
    retrieval: ["precision@k", "recall@k", "mrr", "ndcg@k"]

# Experiment parameters
max_queries: 100
experiment_name: "hybrid_reranking_voyage_premium"
